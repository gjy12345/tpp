{"remainingRequest":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gujianyang/IdeaProjects/cinima_admin/src/views/schedule/schedule.vue?vue&type=style&index=0&id=702b9636&scoped=true&lang=css&","dependencies":[{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/src/views/schedule/schedule.vue","mtime":1621785064337},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouc2NyZWVuewogIHdpZHRoOiA5MCU7CiAgaGVpZ2h0OiA1MHB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmM2Y0ZjY7CiAgbWFyZ2luOiAwIGF1dG87Cn0KLnNjcmVlbi10ZXh0ewogIGNvbG9yOiAjNkJBMkQ2OwogIGxpbmUtaGVpZ2h0OiA1MHB4OwogIHRleHQtYWxpZ246IGNlbnRlcjsKICB3aGl0ZS1zcGFjZTogbm93cmFwOwogIGZvbnQtc2l6ZTogMjBweDsKfQouc2l0ZV9tYXBfY29udGVudHsKICB3aWR0aDogOTAlOwogIG1hcmdpbjogMzBweCBhdXRvIDA7Cn0KLm51bWJlcnsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgY29sb3I6ICNmZmY7CiAgYm9yZGVyOiAwOwogIGZvbnQtc2l6ZTogMTAwJTsKICBmb250LXdlaWdodDogNDAwOwogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsLjMpOwogIHZlcnRpY2FsLWFsaWduOiBiYXNlbGluZTsKICBwYWRkaW5nOiAwIC4wNXJlbTsKICBoZWlnaHQ6IDQwcHg7CiAgd2lkdGg6IDQwcHg7CiAgbWFyZ2luOiAyMHB4IDAgMDsKICBsaW5lLWhlaWdodDogNDBweDsKfQouc2l0ZV9sYXlvdXR7CiAgZGlzcGxheTogZmxleDsKICBmbGV4OiAxOwogIG1hcmdpbjogMCBhdXRvOwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwp9Ci5udW1iZXJ7CiAgd2lkdGg6IDQwcHg7Cn0KLm1iewogIC13ZWJraXQtZmlsdGVyOiBncmF5c2NhbGUoMSk7IC8qIFdlYmtpdCAqLwogIGZpbHRlcjogZ3JheXNjYWxlKDEpOyAvKiBXM0MgKi8KfQouYXV0b0hpZGRlbnsKICBkaXNwbGF5OiAtd2Via2l0LWJveDsKICAtd2Via2l0LWJveC1vcmllbnQ6IHZlcnRpY2FsOwogIC13ZWJraXQtbGluZS1jbGFtcDogNTsKICBvdmVyZmxvdzogaGlkZGVuOwogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwp9Cg=="},{"version":3,"sources":["schedule.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"schedule.vue","sourceRoot":"src/views/schedule","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"filter-container\" style=\"margin: 0;padding: 0\">\n      <div class=\"el-form-item__content\" style=\"display: block;margin: 0;padding: 0\">\n        <span class=\" el-form-item__label\">影院影院:</span>\n        <span v-if=\"cinema\" class=\" el-form-item__label\" style=\"color: deepskyblue\">\n          {{ cinema.name + ' ('+cinema.position + ' - '+ cinema.address + ' )' }}\n        </span>\n        <span v-else class=\" el-form-item__label\" style=\"color: deepskyblue\">\n          暂未选择影院\n        </span>\n        <el-button class=\"filter-item\" type=\"primary\" style=\"margin-right: 10px\" icon=\"el-icon-edit\" @click=\"choseCinema\">\n          选择影院\n        </el-button>\n        <span class=\"filter-item el-form-item__label\" style=\"float: none\">影片:</span>\n        <span v-if=\"film\" class=\"filter-item el-form-item__label\" style=\"color: deepskyblue;float: none\">\n          {{ film.name }}\n        </span>\n        <span v-else class=\"filter-item el-form-item__label\" style=\"color: deepskyblue;float: none\">\n          暂未选择影片\n        </span>\n        <el-button class=\"filter-item\" type=\"primary\" style=\"margin-right: 10px\" icon=\"el-icon-edit\" @click=\"choseFilm\">\n          选择影片\n        </el-button>\n        <span v-if=\"cinema\" class=\"filter-item el-form-item__label\" style=\"float: none\">放映厅:</span>\n        <el-select v-if=\"cinema\" v-model=\"hall\" placeholder=\"放映厅\" style=\"width: 130px;margin-right: 10px\" class=\"filter-item\" @change=\"changeHall\">\n          <el-option label=\"\" value=\"\" />\n          <el-option v-for=\"item in halls\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\" />\n        </el-select>\n        <span v-if=\"hall\" class=\"filter-item el-form-item__label\" style=\";float: none\">\n          初始化票价\n        </span>\n        <el-input v-if=\"hall\" v-model=\"initPrice\" type=\"number\" placeholder=\"价格\" style=\"width: 200px; margin-right: 10px\" class=\"filter-item\" />\n        <el-button v-if=\"hall\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-edit\" @click=\"initAllPrice\">\n          一键初始化\n        </el-button>\n      </div>\n      <div v-if=\"hall!==null && cinema !==null && film!==null && hall !==''\" class=\"filter-container\">\n        <span class=\" el-form-item__label\">上映时间配置:</span>\n        <el-date-picker\n          v-model=\"showBegin\"\n          value-format=\"yyyy-MM-dd HH:mm:ss\"\n          style=\"width: 250px;margin-right: 10px\"\n          class=\"filter-item\"\n          type=\"datetime\"\n          placeholder=\"上映时间\"\n        />\n        <el-date-picker\n          v-model=\"showEnd\"\n          value-format=\"yyyy-MM-dd HH:mm:ss\"\n          style=\"width: 250px;margin-right: 10px\"\n          class=\"filter-item\"\n          type=\"datetime\"\n          placeholder=\"上映结束时间\"\n        />\n        <el-button class=\"filter-item\" type=\"primary\" style=\"margin-right: 10px\" icon=\"el-icon-document-checked\" @click=\"submitSchedule\">\n          排片发布\n        </el-button>\n      </div>\n      <div class=\"filter-container\">\n        <span class=\"filter-item el-form-item__label\" style=\"float: none\">单人座:</span><el-image :src=\"normal\" alt=\"\" height=\"40px\" width=\"40px\" class=\"filter-item\" style=\"width: 40px;height: 40px;margin-right: 10px\" />\n        <span class=\"filter-item el-form-item__label\" style=\"float: none\">情侣座:</span><el-image :src=\"lovers\" alt=\"\" height=\"40px\" width=\"40px\" class=\"filter-item\" style=\"width: 40px;height: 40px\" />\n        <el-image :src=\"lovers_r\" alt=\"\" height=\"40px\" width=\"40px\" style=\"width: 40px;height: 40px;margin-right: 10px\" class=\"filter-item\" />\n        <span class=\"filter-item el-form-item__label\" style=\"float: none\">维修:</span><el-image :src=\"bad\" alt=\"\" class=\"filter-item\" height=\"40px\" width=\"40px\" style=\"width: 40px;height: 40px;margin-right: 10px\" />\n      </div>\n    </div>\n    <div class=\"screen\">\n      <div class=\"screen-text\">屏幕方向</div>\n    </div>\n    <div class=\"site_map_content\">\n      <div v-for=\"index in row\" :key=\"index\">\n        <div class=\"site_layout\">\n          <div class=\"number\" style=\"margin-right: 20px\">{{ index }}</div>\n          <div v-for=\"col_index in col\" :key=\"col_index\" style=\"width: 46px\">\n            <el-popover\n              v-if=\"map[index-1][col_index-1].type>=1 && map[index-1][col_index-1].type<=3\"\n              placement=\"top-start\"\n              title=\"详情\"\n              width=\"100\"\n              trigger=\"click\"\n            >\n              <el-checkbox v-if=\"map[index-1][col_index-1].type>=1 && map[index-1][col_index-1].type<=3\" v-model=\"map[index-1][col_index-1].enable\" @change=\"changeSiteStatus(index-1,col_index-1)\">是否可用</el-checkbox>\n              <el-input v-model=\"map[index-1][col_index-1].price\" placeholder=\"请输入票价\" type=\"number\" />\n              <el-image slot=\"reference\" v-model=\"map[index-1][col_index-1].src\" :src=\"map[index-1][col_index-1].src\" alt=\"\" height=\"40px\" width=\"40px\" style=\"margin-top: 20px\" />\n            </el-popover>\n            <el-image v-else slot=\"reference\" v-model=\"map[index-1][col_index-1].src\" :src=\"map[index-1][col_index-1].src\" alt=\"\" height=\"40px\" width=\"40px\" style=\"margin-top: 20px\" />\n          </div>\n        </div>\n      </div>\n    </div>\n    <el-dialog title=\"选择影院\" :visible.sync=\"cinemaDialogVisible\" width=\"80%\">\n      <div class=\"filter-container\">\n        <el-input v-model=\"cinemaListQuery.id\" placeholder=\"电影院编号\" style=\"width: 200px;\" class=\"filter-item\" @keyup.enter.native=\"getCinemaList\" />\n        <el-input v-model=\"cinemaListQuery.name\" placeholder=\"电影院名\" style=\"width: 200px;margin-left: 10px\" class=\"filter-item\" @keyup.enter.native=\"getCinemaList\" />\n        <el-select v-model=\"selectProvince\" placeholder=\"省\" clearable class=\"filter-item\" style=\"width: 130px;margin-left: 10px\" value-key=\"id\" @change=\"onSelectChanged(0)\">\n          <el-option label=\"\" value=\"\" />\n          <el-option v-for=\"item in provinces\" :key=\"item.id\" :label=\"item.name\" :value=\"item\" />\n        </el-select>\n        <el-select v-model=\"selectCity\" placeholder=\"城市\" clearable class=\"filter-item\" style=\"width: 130px;margin-left: 10px\" value-key=\"id\" @change=\"onSelectChanged(1)\">\n          <el-option label=\"\" value=\"\" />\n          <el-option v-for=\"item in cities\" :key=\"item.id\" :label=\"item.name\" :value=\"item\" />\n        </el-select>\n        <el-select v-model=\"selectCountry\" placeholder=\"县\" clearable class=\"filter-item\" style=\"width: 130px;margin-left: 10px\" value-key=\"id\" @change=\"onSelectChanged(2)\">\n          <el-option label=\"\" value=\"\" />\n          <el-option v-for=\"item in countries\" :key=\"item.id\" :label=\"item.name\" :value=\"item\" />\n        </el-select>\n        <el-select v-model=\"cinemaListQuery.status\" placeholder=\"是否启用\" clearable class=\"filter-item\" style=\"width: 130px;margin-left: 10px\">\n          <el-option label=\"\" value=\"\" />\n          <el-option label=\"启用\" value=\"1\" />\n          <el-option label=\"禁用\" value=\"0\" />\n        </el-select>\n        <el-button class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" icon=\"el-icon-search\" @click=\"getCinemaList\">\n          搜索\n        </el-button>\n        <el-button class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" icon=\"el-icon-refresh-left\" @click=\"resetCinemaQuery\">\n          重置\n        </el-button>\n      </div>\n      <el-table\n        :key=\"cinemaTableKey\"\n        v-loading=\"cinemaListLoading\"\n        :data=\"cinemaList\"\n        border\n        fit\n        highlight-current-row\n        style=\"width: 100%;\"\n        @current-change=\"onSelectCinema\"\n      >\n        <el-table-column label=\"编号\" align=\"center\" width=\"100\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.id }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"影院名\" align=\"center\" width=\"150\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.name }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"地址\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.position + ' - ' + row.address }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column :label=\"'是否可用'\" class-name=\"status-col\" width=\"100\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.status | statusFilter\">\n              {{ row.status===1?'可用':'禁用' }}\n            </el-tag>\n          </template>\n        </el-table-column>\n      </el-table>\n      <pagination v-show=\"cinemaListTotal>0\" :total=\"cinemaListTotal\" :page.sync=\"cinemaListQuery.page\" :limit.sync=\"cinemaListQuery.pageSize\" @pagination=\"getCinemaList\" />\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"cinemaDialogVisible = false\">\n          取消\n        </el-button>\n        <el-button v-if=\"tempSelectCinema\" type=\"primary\" @click=\"dialogChoseCinema\">\n          确定\n        </el-button>\n      </div>\n    </el-dialog>\n    <el-dialog title=\"选择影片\" :visible.sync=\"filmDialogVisible\" width=\"80%\">\n      <div class=\"filter-container\">\n        <el-input v-model=\"filmListQuery.id\" placeholder=\"电影编号\" style=\"width: 200px;\" class=\"filter-item\" @keyup.enter.native=\"getCinemaList\" />\n        <el-input v-model=\"filmListQuery.name\" placeholder=\"电影名\" style=\"width: 200px;margin-left: 10px\" class=\"filter-item\" @keyup.enter.native=\"getCinemaList\" />\n        <el-select v-model=\"filmListQuery.status\" placeholder=\"是否上线\" clearable class=\"filter-item\" style=\"width: 130px;margin-left: 10px\">\n          <el-option label=\"\" value=\"\" />\n          <el-option label=\"启用\" value=\"1\" />\n          <el-option label=\"禁用\" value=\"0\" />\n        </el-select>\n        <el-button class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" icon=\"el-icon-search\" @click=\"getFilmList\">\n          搜索\n        </el-button>\n        <el-button class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" icon=\"el-icon-refresh-left\" @click=\"resetFilmListQuery\">\n          重置\n        </el-button>\n      </div>\n      <el-table\n        :key=\"filmTableId\"\n        v-loading=\"filmListLoading\"\n        :data=\"filmList\"\n        border\n        fit\n        highlight-current-row\n        style=\"width: 100%\"\n        max-height=\"400\"\n        @current-change=\"onSelectFilm\"\n      >\n        <el-table-column label=\"编号\" align=\"center\" width=\"100\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.id }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"电影名\" width=\"150px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <img\n              v-if=\"row.cover\"\n              :src=\"row.cover|concatUrl\"\n              style=\"width: 80%;display: block;margin: 0 auto\"\n            >\n            <span>{{ row.name }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"导演\" width=\"150px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.director }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"国家/地区\" width=\"100px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.region }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"时长\" width=\"80px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.duration }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"主演\" width=\"170px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.star }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"类型\" width=\"120px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag\n              v-for=\"tag in (row.filmTypes==null?[]:row.filmTypes)\"\n              :key=\"tag.id\"\n              style=\"margin-top: 4px\"\n            >\n              {{ tag.name }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"上映时间\" width=\"120px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span>{{ row.showTime }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"简介\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <span class=\"autoHidden\">{{ row.describe }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column :label=\"'是否上线'\" class-name=\"status-col\" width=\"100\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.status | statusFilter\">\n              {{ row.status===1?'上线':'下线' }}\n            </el-tag>\n          </template>\n        </el-table-column>\n      </el-table>\n      <pagination v-show=\"filmListTotal>0\" :total=\"filmListTotal\" :page.sync=\"filmListQuery.page\" :limit.sync=\"filmListQuery.pageSize\" @pagination=\"getFilmList\" />\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"filmDialogVisible = false\">\n          取消\n        </el-button>\n        <el-button v-if=\"tempSelectFilm\" type=\"primary\" @click=\"dialogChoseFilm\">\n          确定\n        </el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { loadSite } from '@/api/doc_hall'\nimport { getCinemaList } from '@/api/doc-cinema'\nimport { getCities, getCountries, getProvinces } from '@/api/position'\nimport Pagination from '@/components/Pagination'\nimport { getAllSimpleHall } from '@/api/doc_hall'\nimport { getFilmList } from '@/api/doc-film'\nimport { getResourceUrl } from '@/api/static'\nimport { uploadScheduleData } from '@/api/schedule-film'\n\nexport default {\n  name: 'Schedule',\n  components: { Pagination },\n  filters: {\n    statusFilter(status) {\n      const statusMap = {\n        1: 'success',\n        0: 'danger'\n      }\n      return statusMap[status]\n    },\n    concatUrl(u) {\n      return getResourceUrl(u)\n    }\n  },\n  data() {\n    return {\n      cinemaTableKey: 1,\n      filmTableId: 2,\n      normal: '/wx.png',\n      lovers: '/qlz_01.png',\n      lovers_r: '/qlz_02.png',\n      bad: '/gz.png',\n      gd: '/gd.png',\n      normal_disabled: '/normal_jz.png',\n      lovers_disabled: '/qlz_jz_01.png',\n      lovers_r_disabled: '/qlz_jz_02.png',\n      tempRow: 0,\n      tempCol: 0,\n      map: [[]],\n      loading: null,\n      col: 0,\n      row: 0,\n      cinema: null,\n      halls: null,\n      hall: null,\n      film: null,\n      cinemaDialogVisible: false,\n      hallDialogVisible: false,\n      cinemaListLoading: false,\n      cinemaList: [],\n      cinemaListQuery: {\n        page: 1,\n        pageSize: 10,\n        status: null,\n        province: null,\n        name: null,\n        city: null,\n        country: null,\n        id: null\n      },\n      provinces: [],\n      cities: [],\n      countries: [],\n      allCities: [],\n      allCountries: [],\n      selectProvince: null,\n      selectCity: null,\n      selectCountry: null,\n      cinemaListTotal: 0,\n      tempSelectCinema: null,\n      initPrice: null,\n      filmDialogVisible: false,\n      filmListQuery: {\n        page: 1,\n        pageSize: 10,\n        status: null,\n        name: null,\n        id: null\n      },\n      filmListTotal: 0,\n      filmList: [],\n      filmListLoading: false,\n      tempSelectFilm: null,\n      showBegin: null,\n      showEnd: null\n    }\n  },\n  watch: {\n    windowHeight(val) {\n      console.log(val)\n    }\n  },\n  created() {\n    this.getSelectData()\n  },\n  methods: {\n    loadSiteData() {\n      this.setLoading(true)\n      loadSite(this.hall).then(res => {\n        if (res.data !== null && res.data.length > 0 && res.data[0].length > 0) {\n          const row = res.data.length\n          const col = res.data[0].length\n          const map = []\n          for (const i in res.data) {\n            const item = []\n            for (const j in res.data[i]) {\n              let src\n              switch (res.data[i][j].type) {\n                case 1:\n                  src = this.normal\n                  break\n                case -1:\n                  src = this.bad\n                  break\n                case 0:\n                  src = this.gd\n                  break\n                case 2:\n                  src = this.lovers\n                  break\n                case 3:\n                  src = this.lovers_r\n                  break\n              }\n              item.push({\n                src: src,\n                sale: false,\n                price: null,\n                enable: true,\n                type: res.data[i][j].type\n              })\n            }\n            map.push(item)\n          }\n          this.map = map\n          this.row = row\n          this.col = col\n        } else {\n          this.$message({\n            message: '加载失败,请检查此影厅是否已初始化',\n            type: 'warning'\n          })\n          this.row = 0\n          this.col = 0\n          this.hall = null\n        }\n        this.setLoading(false)\n      })\n        .catch(e => {\n          this.setLoading(false)\n          this.col = 0\n          this.row = 0\n          throw e\n        })\n    },\n    setLoading(show) {\n      if (show) {\n        this.loading = this.$loading({\n          lock: true,\n          text: 'Loading',\n          spinner: 'el-icon-loading',\n          background: 'rgba(0, 0, 0, 0.7)'\n        })\n      } else {\n        setTimeout(() => {\n          this.loading.close()\n        }, 500)\n      }\n    },\n    dialogChoseCinema() {\n      this.cinema = this.tempSelectCinema\n      this.cinemaDialogVisible = false\n      this.setLoading(true)\n      getAllSimpleHall(this.cinema.id).then(res => {\n        this.halls = res.data\n        this.setLoading(false)\n      }).catch(_ => {\n        this.setLoading(false)\n        throw _\n      })\n    },\n    choseCinema() {\n      this.resetCinemaQuery()\n      this.tempSelectCinema = null\n      this.cinemaDialogVisible = true\n      this.hall = null\n      this.changeHall()\n      this.getCinemaList()\n    },\n    getCinemaList() {\n      this.cinemaListLoading = true\n      getCinemaList(this.cinemaListQuery).then(res => {\n        this.cinemaList = res.data.list\n        this.cinemaListTotal = res.data.total\n        this.cinemaListLoading = false\n      }).catch(_ => {\n        this.cinemaListLoading = false\n        throw _\n      })\n    },\n    resetCinemaQuery() {\n      this.cinlistQuery = {\n        page: 1,\n        pageSize: 10,\n        status: null,\n        province: null,\n        name: null,\n        city: null,\n        country: null,\n        id: null\n      }\n      this.selectProvince = null\n      this.selectCountry = null\n      this.selectCity = null\n      // 获取列表\n      this.getCinemaList()\n    },\n    onSelectChanged(type) {\n      switch (type) {\n        case 0:\n          this.countries = []\n          this.cinemaListQuery.city = null\n          this.cinemaListQuery.country = null\n          this.selectCountry = null\n          this.selectCity = null\n          this.cinemaListQuery.province = this.selectProvince.name\n          this.cities = this.allCities.filter(value => {\n            return value.pid === this.selectProvince.id\n          })\n          break\n        case 1:\n          this.cinemaListQuery.country = null\n          this.selectCountry = null\n          this.cinemaListQuery.city = this.selectCity.name\n          this.countries = this.allCountries.filter(value => {\n            return value.pid === this.selectCity.id\n          })\n          break\n        case 2:\n          this.cinemaListQuery.country = this.selectCountry.name\n          break\n      }\n    },\n    getSelectData() {\n      getProvinces().then(res => {\n        this.provinces = res.data\n      })\n      getCountries().then(res => {\n        this.allCountries = res.data\n      })\n      getCities().then(res => {\n        this.allCities = res.data\n      })\n    },\n    onSelectCinema(currentRow, oldCurrentRow) {\n      this.tempSelectCinema = currentRow\n    },\n    choseFilm() {\n      this.resetFilmListQuery()\n      this.tempSelectFilm = null\n      this.filmDialogVisible = true\n      this.getFilmList()\n    },\n    changeHall() {\n      if (this.hall === null || this.hall === '') {\n        this.col = 0\n        this.row = 0\n      } else {\n        this.loadSiteData()\n      }\n    },\n    changeSiteStatus(row_index, col_index) {\n      const data = this.map[row_index][col_index]\n      if (data.type === 2) {\n        this.map[row_index][col_index + 1].enable = data.enable\n        this.map[row_index][col_index + 1].src = this.getSrc(this.map[row_index][col_index + 1])\n      } else if (data.type === 3) {\n        this.map[row_index][col_index - 1].enable = data.enable\n        this.map[row_index][col_index - 1].src = this.getSrc(this.map[row_index][col_index - 1])\n      }\n      data.src = this.getSrc(data)\n    },\n    getSrc(row) {\n      let src\n      switch (row.type) {\n        case 1:\n          src = row.enable ? this.normal : this.normal_disabled\n          break\n        case 2:\n          src = row.enable ? this.lovers : this.lovers_disabled\n          break\n        case 3:\n          src = row.enable ? this.lovers_r : this.lovers_r_disabled\n          break\n      }\n      return src\n    },\n    initAllPrice() {\n      if (this.initPrice === null || this.initPrice === '') {\n        this.$message.warning('请输入价格')\n        return\n      }\n      if (this.hall === null || this.map === null || this.map.length === 0) {\n        this.$message.warning('当前放映厅错误!')\n        return\n      }\n      for (const i in this.map) {\n        for (const j in this.map[i]) {\n          const item = this.map[i][j]\n          if (item.enable && item.type >= 1 && item.type <= 3) {\n            this.map[i][j].price = this.initPrice\n          }\n        }\n      }\n      this.$message.success('初始化成功!')\n    },\n    resetFilmListQuery() {\n      this.filmListQuery = {\n        page: 1,\n        pageSize: 10,\n        status: null,\n        name: null,\n        id: null\n      }\n    },\n    getFilmList() {\n      this.filmListLoading = true\n      getFilmList(this.filmListQuery).then(res => {\n        this.filmList = res.data.list\n        this.filmListTotal = res.data.total\n        this.filmListLoading = false\n      }).catch(_ => {\n        this.filmListLoading = false\n        throw _\n      })\n    },\n    dialogChoseFilm() {\n      this.film = this.tempSelectFilm\n      this.filmDialogVisible = false\n    },\n    onSelectFilm(currentRow, oldCurrentRow) {\n      this.tempSelectFilm = currentRow\n    },\n    submitSchedule() {\n      const map = this.map\n      for (const i in map) {\n        for (const j in map[i]) {\n          const x = Number(i) + 1\n          const y = Number(j) + 1\n          const item = map[i][j]\n          if (!item.enable || item.type < 1 || item.type > 3) { continue }\n          if (item.price === undefined || item.price === null) {\n            this.$message.error('请设置第' + x + '排,第' + y + '列座位的价格!')\n            return\n          }\n          const price = item.price + ''\n          if (price.match('^\\\\+?[1-9][0-9]*$ ')) {\n            this.$message.error('请设置第' + x + '排,第' + y + '列价格有误!')\n            return\n          }\n        }\n      }\n      const upData = {\n        cinemaId: this.cinema.id,\n        filmId: this.film.id,\n        hallId: this.hall,\n        sites: this.map,\n        beginTime: this.showBegin,\n        endTime: this.showEnd\n      }\n      this.setLoading(true)\n      uploadScheduleData(upData).then(_ => {\n        this.$message.success('发布成功')\n        this.setLoading(false)\n        this.resetAll()\n      }).catch(_ => {\n        this.setLoading(false)\n      })\n    },\n    resetAll() {\n      this.hall = null\n      this.cinema = null\n      this.film = null\n      this.map = []\n      this.initPrice = null\n      this.beginTime = null\n      this.endTime = null\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .screen{\n    width: 90%;\n    height: 50px;\n    background-color: #f3f4f6;\n    margin: 0 auto;\n  }\n  .screen-text{\n    color: #6BA2D6;\n    line-height: 50px;\n    text-align: center;\n    white-space: nowrap;\n    font-size: 20px;\n  }\n  .site_map_content{\n    width: 90%;\n    margin: 30px auto 0;\n  }\n  .number{\n    text-align: center;\n    color: #fff;\n    border: 0;\n    font-size: 100%;\n    font-weight: 400;\n    background-color: rgba(0,0,0,.3);\n    vertical-align: baseline;\n    padding: 0 .05rem;\n    height: 40px;\n    width: 40px;\n    margin: 20px 0 0;\n    line-height: 40px;\n  }\n  .site_layout{\n    display: flex;\n    flex: 1;\n    margin: 0 auto;\n    justify-content: center;\n  }\n  .number{\n    width: 40px;\n  }\n  .mb{\n    -webkit-filter: grayscale(1); /* Webkit */\n    filter: grayscale(1); /* W3C */\n  }\n  .autoHidden{\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 5;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n</style>\n"]}]}