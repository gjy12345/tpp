{"remainingRequest":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gujianyang/IdeaProjects/cinima_admin/src/views/user/user-manage.vue?vue&type=style&index=0&id=4f851806&scoped=true&lang=css&","dependencies":[{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/src/views/user/user-manage.vue","mtime":1621866605833},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gujianyang/IdeaProjects/cinima_admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5hdmF0YXItdXBsb2FkZXIgLmVsLXVwbG9hZCB7CiAgYm9yZGVyOiAxcHggZGFzaGVkIGJsYWNrOwogIGJvcmRlci1yYWRpdXM6IDZweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIG92ZXJmbG93OiBoaWRkZW47Cn0KLmF2YXRhci11cGxvYWRlciAuZWwtdXBsb2FkOmhvdmVyIHsKICBib3JkZXItY29sb3I6ICM0MDlFRkY7Cn0KLmF2YXRhci11cGxvYWRlci1pY29uIHsKICBmb250LXNpemU6IDI4cHg7CiAgY29sb3I6ICM4YzkzOWQ7CiAgd2lkdGg6IDE3OHB4OwogIGhlaWdodDogMTc4cHg7CiAgbGluZS1oZWlnaHQ6IDE3OHB4OwogIHRleHQtYWxpZ246IGNlbnRlcjsKfQouYXZhdGFyIHsKICB3aWR0aDogMTc4cHg7CiAgZGlzcGxheTogYmxvY2s7Cn0K"},{"version":3,"sources":["user-manage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user-manage.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"filter-container\">\n      <el-input v-model=\"listQuery.name\" placeholder=\"用户名或账号\" style=\"width: 200px;margin-right: 10px\" class=\"filter-item\" @keyup.enter.native=\"getList\" />\n      <el-input v-model=\"listQuery.phone\" placeholder=\"电话\" style=\"width: 200px;margin-right: 10px\" class=\"filter-item\" @keyup.enter.native=\"getList\" />\n      <el-select v-model=\"listQuery.sex\" placeholder=\"性别\" clearable class=\"filter-item\" style=\"width: 120px;margin-right: 10px\">\n        <el-option label=\"未选择\" value=\"\" />\n        <el-option label=\"男\" value=\"1\" />\n        <el-option label=\"女\" value=\"0\" />\n      </el-select>\n      <el-select v-model=\"listQuery.locked\" placeholder=\"是否启用\" clearable class=\"filter-item\" style=\"width: 120px;margin-right: 10px\">\n        <el-option label=\"未选择\" value=\"\" />\n        <el-option label=\"启用\" value=\"1\" />\n        <el-option label=\"禁用\" value=\"0\" />\n      </el-select>\n      <el-date-picker\n        v-model=\"listQuery.begin\"\n        value-format=\"yyyy-MM-dd HH:mm:ss\"\n        style=\"width: 250px;margin-right: 10px\"\n        class=\"filter-item\"\n        type=\"datetime\"\n        placeholder=\"注册时间\"\n      />\n      <el-date-picker\n        v-model=\"listQuery.end\"\n        value-format=\"yyyy-MM-dd HH:mm:ss\"\n        style=\"width: 250px;margin-right: 10px\"\n        class=\"filter-item\"\n        type=\"datetime\"\n        placeholder=\"注册时间尾\"\n      />\n      <el-button class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" icon=\"el-icon-search\" @click=\"getList\">\n        搜索\n      </el-button>\n      <el-button class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" icon=\"el-icon-refresh-left\" @click=\"resetQueryParams\">\n        重置\n      </el-button>\n    </div>\n    <el-table\n      :key=\"tableKey\"\n      v-loading=\"listLoading\"\n      :data=\"list\"\n      border\n      fit\n      highlight-current-row\n      style=\"width: 100%;\"\n    >\n      <el-table-column label=\"序号\" align=\"center\" width=\"80\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.id }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"头像\" min-width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <el-popover\n            placement=\"top-start\"\n            title=\"详情\"\n            width=\"350\"\n            trigger=\"hover\"\n          >\n            <el-image :src=\"row.avatar|concatUrl\" width=\"100%\" />\n            <el-image slot=\"reference\" :src=\"row.avatar|concatUrl\" style=\"max-width: 60px\" />\n          </el-popover>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"手机号\" min-width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.phone }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"昵称\" min-width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.nickname }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"性别\" min-width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.sex === 1?'男':'女' }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"生日\" min-width=\"150px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.birthday }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"上一次登录\" width=\"170px\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.lastLoginTime }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"注册时间\" width=\"170px\">\n        <template slot-scope=\"{row}\">\n          <span>{{ row.createTime }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"是否可用\" class-name=\"status-col\" width=\"100\">\n        <template slot-scope=\"{row}\">\n          <el-tag :type=\"row.locked | lockedFilter\">\n            {{ row.locked===0?'可用':'禁用' }}\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" align=\"center\" width=\"230\" class-name=\"small-padding fixed-width\">\n        <template slot-scope=\"{row,$index}\">\n          <el-button type=\"primary\" size=\"mini\" @click=\"handleUpdate(row)\">\n            编辑\n          </el-button>\n          <el-button type=\"waining\" size=\"mini\" @click=\"handleResetPwd(row)\">\n            重置密码\n          </el-button>\n          <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(row,$index)\">\n            删除\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.pageSize\" @pagination=\"getList\" />\n    <!--  新增  修改-->\n    <el-dialog :title=\"dialogType==='create'?'新增':'修改'\" :visible.sync=\"dialogVisible\">\n      <el-form ref=\"dataForm\" :rules=\"rules\" :model=\"temp\" label-position=\"right\" label-width=\"80px\" style=\"width: 400px; margin-left:50px;\">\n        <el-form-item label=\"头像\">\n          <el-upload\n            class=\"avatar-uploader\"\n            :action=\"uploadResourceUrl\"\n            :headers=\"uploadHeader\"\n            :show-file-list=\"false\"\n            :on-success=\"handleCoverSuccess\"\n            :before-upload=\"beforeCoverUpload\"\n          >\n            <img v-if=\"temp.avatar!=null\" :src=\"temp.avatar|concatUrl\" class=\"avatar\">\n            <i v-else class=\"el-icon-plus avatar-uploader-icon el-upload\" />\n          </el-upload>\n        </el-form-item>\n        <el-form-item label=\"昵称\" prop=\"nickname\">\n          <el-input v-model=\"temp.nickname\" />\n        </el-form-item>\n        <el-form-item label=\"手机号\" prop=\"phone\">\n          <el-input v-model=\"temp.phone\" />\n        </el-form-item>\n        <el-form-item label=\"性别\" prop=\"sex\">\n          <el-select v-model=\"temp.sex\" class=\"filter-item\" placeholder=\"Please select\">\n            <el-option label=\"男\" :value=\"1\" />\n            <el-option label=\"女\" :value=\"0\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"是否启用\" prop=\"status\">\n          <el-select v-model=\"temp.locked\" class=\"filter-item\" placeholder=\"Please select\">\n            <el-option label=\"启用\" :value=\"1\" />\n            <el-option label=\"禁用\" :value=\"0\" />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">\n          取消\n        </el-button>\n        <el-button type=\"primary\" @click=\"dialogType==='create'?createData():updateData()\">\n          确定\n        </el-button>\n      </div>\n    </el-dialog>\n    <el-dialog title=\"重置密码\" :visible.sync=\"resetPwdDialogVisible\">\n      <el-form ref=\"resetPwdForm\" :rules=\"rules\" :model=\"temp\" label-position=\"left\" label-width=\"80px\" style=\"width: 400px; margin-left:50px;\">\n        <el-form-item label=\"密码\" prop=\"resetPwd\">\n          <el-input v-model=\"temp.resetPwd\" />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"resetPwdDialogVisible = false\">\n          取消\n        </el-button>\n        <el-button type=\"primary\" @click=\"resetPwd\">\n          确定\n        </el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { getResourceUrl } from '@/api/static'\nimport Pagination from '@/components/Pagination'\nimport { deleteCustomer, getCustomerList, resetPassword, updateCustomer } from '@/api/customer'\nimport { getToken } from '@/utils/auth'\n// import Pagination from '@/components/Pagination' // secondary package based on el-pagination\nexport default {\n  name: 'UserManage',\n  components: { Pagination },\n  filters: {\n    lockedFilter(status) {\n      const lockedFilter = {\n        0: 'success',\n        1: 'danger'\n      }\n      return lockedFilter[status]\n    },\n    concatUrl(url) {\n      return getResourceUrl(url)\n    }\n  },\n  data() {\n    return {\n      tableKey: 0,\n      list: null,\n      total: 0,\n      listLoading: false,\n      uploadResourceUrl: process.env.VUE_APP_BASE_API + '/common/file/uploadImages',\n      uploadHeader: {\n        'Token': getToken()\n      },\n      listQuery: {\n        page: 1,\n        pageSize: 10,\n        name: null,\n        locked: null,\n        sex: null,\n        phone: null,\n        begin: null,\n        end: null\n      },\n      dialogVisible: false,\n      dialogType: null,\n      temp: {\n        id: undefined,\n        reason: '',\n        type: '',\n        status: ''\n      },\n      rules: {\n        nickname: [{ required: true, message: '请填入昵称', trigger: 'change' }],\n        phone: [{ required: true, message: '请填入手机号', trigger: 'change' }],\n        resetPwd: [{ required: true, message: '请填入密码', trigger: 'change' }],\n        locked: [{ required: true, message: '请选择状态', trigger: 'change' }],\n        sex: [{ required: true, message: '请选择性别', trigger: 'change' }]\n      },\n      resetPwdDialogVisible: false\n    }\n  },\n  created() {\n    this.getList()\n  },\n  methods: {\n    handleFilter() {\n    },\n    getList() {\n      this.listLoading = true\n      getCustomerList(this.listQuery).then(res => {\n        this.list = res.data.list\n        this.total = res.data.total\n        this.listLoading = false\n      })\n    },\n    handleUpdate(row) {\n      this.temp = Object.assign({}, row) // copy obj\n      this.dialogType = 'update'\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['dataForm'].clearValidate()\n      })\n    },\n    handleDelete(row, index) {\n      this.$confirm('确认删除？')\n        .then(_ => {\n          deleteCustomer(row.id).then(_ => {\n            this.$notify({\n              title: '成功',\n              message: '删除成功',\n              type: 'success',\n              duration: 2000\n            })\n            this.list.splice(index, 1)\n          })\n        })\n        .catch(_ => {})\n    },\n    updateData() {\n      this.$refs['dataForm'].validate((valid) => {\n        if (valid) {\n          const tempData = Object.assign({}, this.temp)\n          updateCustomer(tempData).then(() => {\n            const index = this.list.findIndex(v => v.id === this.temp.id)\n            this.list.splice(index, 1, this.temp)\n            this.dialogVisible = false\n            this.$notify({\n              title: '成功',\n              message: '更新成功',\n              type: 'success',\n              duration: 2000\n            })\n          })\n        }\n      })\n    },\n    resetQueryParams() {\n      this.listQuery = {\n        page: 1,\n        pageSize: 10,\n        name: null,\n        locked: null,\n        sex: null,\n        phone: null,\n        begin: null,\n        end: null\n      }\n      this.getList()\n    },\n    resetTemp() {\n      this.temp = {\n        id: undefined,\n        name: null,\n        locked: null,\n        sex: null,\n        phone: null,\n        begin: null,\n        end: null\n      }\n    },\n    handleResetPwd(row) {\n      this.temp = Object.assign({}, row) // copy obj\n      this.resetPwdDialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['resetPwdForm'].clearValidate()\n      })\n    },\n    resetPwd() {\n      this.$refs['resetPwdForm'].validate((valid) => {\n        if (valid) {\n          resetPassword(this.temp.id, this.temp.resetPwd).then(() => {\n            this.resetPwdDialogVisible = false\n            this.$notify({\n              title: '成功',\n              message: '更新成功',\n              type: 'success',\n              duration: 2000\n            })\n          })\n        }\n      })\n    },\n    handleCoverSuccess(res, file) {\n      if (res.code === 20000) {\n        this.temp.avatar = res.data\n      } else {\n        this.$notify({\n          title: '失败',\n          message: res.msg | '上传失败',\n          type: 'success',\n          duration: 2000\n        })\n      }\n    },\n    beforeCoverUpload(file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png' || file.type === 'image/gif'\n      const isLt2M = file.size / 1024 / 1024 < 2\n      if (!isJPG) {\n        this.$message.error('上传头像只能是 JPG 格式!')\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像大小不能超过 2MB!')\n      }\n      return isJPG && isLt2M\n    }\n  }\n}\n</script>\n\n<style scoped>\n.avatar-uploader .el-upload {\n  border: 1px dashed black;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  display: block;\n}\n</style>\n"]}]}